import pandas as pd


df = pd.read_excel('ادارة مرافق.xlsx')
# عرض أول 10 صفوف من البيانات
print(df.head(10))



# إجمالي تكلفة الصيانة لكل نوع صيانة
تكلفة_الصيانة_حسب_النوع = df.groupby('نوع الصيانة')['تكلفة الصيانة (دولار)'].sum().reset_index()
print("إجمالي تكلفة الصيانة لكل نوع صيانة:\n", تكلفة_الصيانة_حسب_النوع)

# عدد العمليات لكل نوع صيانة
عدد_العمليات_حسب_النوع = df['نوع الصيانة'].value_counts().reset_index()
عدد_العمليات_حسب_النوع.columns = ['نوع الصيانة', 'عدد العمليات']
print("عدد العمليات لكل نوع صيانة:\n", عدد_العمليات_حسب_النوع)

# أغلى عملية صيانة تمت
أغلى_عملية = df.loc[df['تكلفة الصيانة (دولار)'].idxmax(), ['رقم العملية', 'تكلفة الصيانة (دولار)']]
print("أغلى عملية صيانة:\n", أغلى_عملية)

# أكثر موقع تعرض للصيانة
أكثر_موقع_صيانة = df['الموقع'].value_counts().idxmax()
print("أكثر موقع تعرض للصيانة:", أكثر_موقع_صيانة)

# عدد العمليات لكل حالة طلب
عدد_العمليات_حسب_الحالة = df['حالة الطلب'].value_counts().reset_index()
عدد_العمليات_حسب_الحالة.columns = ['حالة الطلب', 'عدد العمليات']
print("عدد العمليات لكل حالة طلب:\n", عدد_العمليات_حسب_الحالة)

# متوسط مدة التنفيذ لكل نوع صيانة
متوسط_المدة_حسب_النوع = df.groupby('نوع الصيانة')['مدة التنفيذ (ساعات)'].mean().reset_index()
print("متوسط مدة التنفيذ لكل نوع صيانة:\n", متوسط_المدة_حسب_النوع)

# أكثر المعدات التي خضعت للصيانة
أكثر_معدات_صيانة = df['المعدات المعنية'].value_counts().idxmax()
print("أكثر المعدات خضوعًا للصيانة:", أكثر_معدات_صيانة)

# مجموع استهلاك الطاقة لكل موقع
استهلاك_الطاقة_حسب_الموقع = df.groupby('الموقع')['استهلاك الطاقة (كيلوواط/ساعة)'].sum().reset_index()
print("مجموع استهلاك الطاقة لكل موقع:\n", استهلاك_الطاقة_حسب_الموقع)

# عدد العمليات لكل مستوى أهمية
عدد_العمليات_حسب_الأهمية = df['مستوى الأهمية'].value_counts().reset_index()
عدد_العمليات_حسب_الأهمية.columns = ['مستوى الأهمية', 'عدد العمليات']
print("عدد العمليات لكل مستوى أهمية:\n", عدد_العمليات_حسب_الأهمية)

# أكثر شهر تم فيه تنفيذ عمليات صيانة
df['تاريخ الإنجاز'] = pd.to_datetime(df['تاريخ الإنجاز'])
df['شهر الإنجاز'] = df['تاريخ الإنجاز'].dt.month
أكثر_شهر = df['شهر الإنجاز'].value_counts().idxmax()
print("أكثر شهر تم فيه تنفيذ عمليات صيانة:", أكثر_شهر)

# معدل الأعطال لكل نوع صيانة
معدل_الأعطال_حسب_النوع = df.groupby('نوع الصيانة')['معدل الأعطال'].mean().reset_index()
print("معدل الأعطال لكل نوع صيانة:\n", معدل_الأعطال_حسب_النوع)

# إجمالي تكلفة الصيانة لكل موقع
تكلفة_الصيانة_حسب_الموقع = df.groupby('الموقع')['تكلفة الصيانة (دولار)'].sum().reset_index()
print("إجمالي تكلفة الصيانة لكل موقع:\n", تكلفة_الصيانة_حسب_الموقع)

# العمليات التي استغرقت أكثر من المتوسط
متوسط_المدة = df['مدة التنفيذ (ساعات)'].mean()
عمليات_أطول_من_المتوسط = df[df['مدة التنفيذ (ساعات)'] > متوسط_المدة]
print("العمليات التي استغرقت أكثر من المتوسط:\n", عمليات_أطول_من_المتوسط)

# العمليات التي تحتوي على ملاحظات
عمليات_بملاحظات = df[df['ملاحظات'] != 'لا توجد ملاحظات']
print("العمليات التي تحتوي على ملاحظات:\n", عمليات_بملاحظات)

# العمليات التي لم يتم تنفيذها بعد
عمليات_غير_مكتملة = df[df['حالة الطلب'] != 'مكتمل']
print("العمليات التي لم يتم تنفيذها بعد:\n", عمليات_غير_مكتملة)

# الفرق بين تاريخ الطلب وتاريخ الإنجاز (مدة التأخير)
df['مدة التأخير'] = (df['تاريخ الإنجاز'] - df['تاريخ الطلب']).dt.days
print("مدة التأخير لكل عملية:\n", df[['رقم العملية', 'مدة التأخير']])

# إجمالي عدد الموظفين لكل موقع
عدد_الموظفين_حسب_الموقع = df.groupby('الموقع')['عدد الموظفين'].sum().reset_index()
print("إجمالي عدد الموظفين لكل موقع:\n", عدد_الموظفين_حسب_الموقع)

# العمليات التي تجاوزت 30 يومًا في التنفيذ
عمليات_طويلة_التنفيذ = df[df['مدة التنفيذ (ساعات)'] > 30]
print("العمليات التي تجاوزت 30 يومًا في التنفيذ:\n", عمليات_طويلة_التنفيذ)

# تحليل الطلبات الملغاة
طلبات_ملغاة = df[df['حالة الطلب'] == 'ملغي']
print("تفاصيل الطلبات الملغاة:\n", طلبات_ملغاة)

# عدد العمليات لكل معدة حسب نوع الصيانة
عدد_العمليات_حسب_المعدات_والنوع = df.groupby(['المعدات المعنية', 'نوع الصيانة']).size().reset_index(name='عدد العمليات')
print("عدد العمليات لكل معدة حسب نوع الصيانة:\n", عدد_العمليات_حسب_المعدات_والنوع)





